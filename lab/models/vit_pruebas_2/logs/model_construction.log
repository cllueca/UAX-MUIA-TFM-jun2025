[2025-06-09 10:47:45] Configuration saved to: '/home/promise/jhernandez/3d-notebooks/3d/9jun25/9jun25/models/vit_pruebas_2/config/model_config.json'...
[2025-06-09 10:47:45] Warning: 3D input detected, ViT will reshape to process all slices: (B*D, C, H, W)
[2025-06-09 10:47:45] Enhanced ViT Configuration: 961 patches (31x31), 8 transformer blocks, 768 embedding dimension
[2025-06-09 10:47:45] Overlap ratio: 0.5, Effective stride: 4
[2025-06-09 10:47:46] Processing 3D input: flattening 8 slices into batch dimension
[2025-06-09 10:47:49] ==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
VisionTransformer                        [1, 1, 8, 128, 128]       738,816
├─pos_embed                                                        ├─738,048
├─cls_token                                                        └─768
├─Conv2d: 1-1                            [8, 768, 31, 31]          49,920
│    └─weight                                                      ├─49,152
│    └─bias                                                        └─768
├─Dropout: 1-2                           [8, 961, 768]             --
├─ModuleList: 1-3                        --                        --
│    └─0.norm1.weight                                              ├─768
│    └─0.norm1.bias                                                ├─768
│    └─0.attn.in_proj_weight                                       ├─1,769,472
│    └─0.attn.in_proj_bias                                         ├─2,304
│    └─0.attn.out_proj.weight                                      ├─589,824
│    └─0.attn.out_proj.bias                                        ├─768
│    └─0.spatial_norm.weight                                       ├─768
│    └─0.spatial_norm.bias                                         ├─768
│    └─0.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─0.spatial_attn.in_proj_bias                                 ├─2,304
│    └─0.spatial_attn.out_proj.weight                              ├─589,824
│    └─0.spatial_attn.out_proj.bias                                ├─768
│    └─0.norm2.weight                                              ├─768
│    └─0.norm2.bias                                                ├─768
│    └─0.mlp.0.weight                                              ├─2,359,296
│    └─0.mlp.0.bias                                                ├─3,072
│    └─0.mlp.3.weight                                              ├─2,359,296
│    └─0.mlp.3.bias                                                ├─768
│    └─1.norm1.weight                                              ├─768
│    └─1.norm1.bias                                                ├─768
│    └─1.attn.in_proj_weight                                       ├─1,769,472
│    └─1.attn.in_proj_bias                                         ├─2,304
│    └─1.attn.out_proj.weight                                      ├─589,824
│    └─1.attn.out_proj.bias                                        ├─768
│    └─1.spatial_norm.weight                                       ├─768
│    └─1.spatial_norm.bias                                         ├─768
│    └─1.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─1.spatial_attn.in_proj_bias                                 ├─2,304
│    └─1.spatial_attn.out_proj.weight                              ├─589,824
│    └─1.spatial_attn.out_proj.bias                                ├─768
│    └─1.norm2.weight                                              ├─768
│    └─1.norm2.bias                                                ├─768
│    └─1.mlp.0.weight                                              ├─2,359,296
│    └─1.mlp.0.bias                                                ├─3,072
│    └─1.mlp.3.weight                                              ├─2,359,296
│    └─1.mlp.3.bias                                                ├─768
│    └─2.norm1.weight                                              ├─768
│    └─2.norm1.bias                                                ├─768
│    └─2.attn.in_proj_weight                                       ├─1,769,472
│    └─2.attn.in_proj_bias                                         ├─2,304
│    └─2.attn.out_proj.weight                                      ├─589,824
│    └─2.attn.out_proj.bias                                        ├─768
│    └─2.spatial_norm.weight                                       ├─768
│    └─2.spatial_norm.bias                                         ├─768
│    └─2.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─2.spatial_attn.in_proj_bias                                 ├─2,304
│    └─2.spatial_attn.out_proj.weight                              ├─589,824
│    └─2.spatial_attn.out_proj.bias                                ├─768
│    └─2.norm2.weight                                              ├─768
│    └─2.norm2.bias                                                ├─768
│    └─2.mlp.0.weight                                              ├─2,359,296
│    └─2.mlp.0.bias                                                ├─3,072
│    └─2.mlp.3.weight                                              ├─2,359,296
│    └─2.mlp.3.bias                                                ├─768
│    └─3.norm1.weight                                              ├─768
│    └─3.norm1.bias                                                ├─768
│    └─3.attn.in_proj_weight                                       ├─1,769,472
│    └─3.attn.in_proj_bias                                         ├─2,304
│    └─3.attn.out_proj.weight                                      ├─589,824
│    └─3.attn.out_proj.bias                                        ├─768
│    └─3.spatial_norm.weight                                       ├─768
│    └─3.spatial_norm.bias                                         ├─768
│    └─3.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─3.spatial_attn.in_proj_bias                                 ├─2,304
│    └─3.spatial_attn.out_proj.weight                              ├─589,824
│    └─3.spatial_attn.out_proj.bias                                ├─768
│    └─3.norm2.weight                                              ├─768
│    └─3.norm2.bias                                                ├─768
│    └─3.mlp.0.weight                                              ├─2,359,296
│    └─3.mlp.0.bias                                                ├─3,072
│    └─3.mlp.3.weight                                              ├─2,359,296
│    └─3.mlp.3.bias                                                ├─768
│    └─4.norm1.weight                                              ├─768
│    └─4.norm1.bias                                                ├─768
│    └─4.attn.in_proj_weight                                       ├─1,769,472
│    └─4.attn.in_proj_bias                                         ├─2,304
│    └─4.attn.out_proj.weight                                      ├─589,824
│    └─4.attn.out_proj.bias                                        ├─768
│    └─4.spatial_norm.weight                                       ├─768
│    └─4.spatial_norm.bias                                         ├─768
│    └─4.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─4.spatial_attn.in_proj_bias                                 ├─2,304
│    └─4.spatial_attn.out_proj.weight                              ├─589,824
│    └─4.spatial_attn.out_proj.bias                                ├─768
│    └─4.norm2.weight                                              ├─768
│    └─4.norm2.bias                                                ├─768
│    └─4.mlp.0.weight                                              ├─2,359,296
│    └─4.mlp.0.bias                                                ├─3,072
│    └─4.mlp.3.weight                                              ├─2,359,296
│    └─4.mlp.3.bias                                                ├─768
│    └─5.norm1.weight                                              ├─768
│    └─5.norm1.bias                                                ├─768
│    └─5.attn.in_proj_weight                                       ├─1,769,472
│    └─5.attn.in_proj_bias                                         ├─2,304
│    └─5.attn.out_proj.weight                                      ├─589,824
│    └─5.attn.out_proj.bias                                        ├─768
│    └─5.spatial_norm.weight                                       ├─768
│    └─5.spatial_norm.bias                                         ├─768
│    └─5.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─5.spatial_attn.in_proj_bias                                 ├─2,304
│    └─5.spatial_attn.out_proj.weight                              ├─589,824
│    └─5.spatial_attn.out_proj.bias                                ├─768
│    └─5.norm2.weight                                              ├─768
│    └─5.norm2.bias                                                ├─768
│    └─5.mlp.0.weight                                              ├─2,359,296
│    └─5.mlp.0.bias                                                ├─3,072
│    └─5.mlp.3.weight                                              ├─2,359,296
│    └─5.mlp.3.bias                                                ├─768
│    └─6.norm1.weight                                              ├─768
│    └─6.norm1.bias                                                ├─768
│    └─6.attn.in_proj_weight                                       ├─1,769,472
│    └─6.attn.in_proj_bias                                         ├─2,304
│    └─6.attn.out_proj.weight                                      ├─589,824
│    └─6.attn.out_proj.bias                                        ├─768
│    └─6.spatial_norm.weight                                       ├─768
│    └─6.spatial_norm.bias                                         ├─768
│    └─6.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─6.spatial_attn.in_proj_bias                                 ├─2,304
│    └─6.spatial_attn.out_proj.weight                              ├─589,824
│    └─6.spatial_attn.out_proj.bias                                ├─768
│    └─6.norm2.weight                                              ├─768
│    └─6.norm2.bias                                                ├─768
│    └─6.mlp.0.weight                                              ├─2,359,296
│    └─6.mlp.0.bias                                                ├─3,072
│    └─6.mlp.3.weight                                              ├─2,359,296
│    └─6.mlp.3.bias                                                ├─768
│    └─7.norm1.weight                                              ├─768
│    └─7.norm1.bias                                                ├─768
│    └─7.attn.in_proj_weight                                       ├─1,769,472
│    └─7.attn.in_proj_bias                                         ├─2,304
│    └─7.attn.out_proj.weight                                      ├─589,824
│    └─7.attn.out_proj.bias                                        ├─768
│    └─7.spatial_norm.weight                                       ├─768
│    └─7.spatial_norm.bias                                         ├─768
│    └─7.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─7.spatial_attn.in_proj_bias                                 ├─2,304
│    └─7.spatial_attn.out_proj.weight                              ├─589,824
│    └─7.spatial_attn.out_proj.bias                                ├─768
│    └─7.norm2.weight                                              ├─768
│    └─7.norm2.bias                                                ├─768
│    └─7.mlp.0.weight                                              ├─2,359,296
│    └─7.mlp.0.bias                                                ├─3,072
│    └─7.mlp.3.weight                                              ├─2,359,296
│    └─7.mlp.3.bias                                                └─768
│    └─SpatialTransformerBlock: 2-1      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-1               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-2      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-3               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-4      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-5               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-6              [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-1             [8, 961, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-2               [8, 961, 3072]            --
│    │    │    └─Dropout: 4-3            [8, 961, 3072]            --
│    │    │    └─Linear: 4-4             [8, 961, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-5            [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-2      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-7               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-8      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-9               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-10     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-11              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-12             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-6             [8, 961, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-7               [8, 961, 3072]            --
│    │    │    └─Dropout: 4-8            [8, 961, 3072]            --
│    │    │    └─Linear: 4-9             [8, 961, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-10           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-3      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-13              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-14     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-15              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-16     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-17              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-18             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-11            [8, 961, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-12              [8, 961, 3072]            --
│    │    │    └─Dropout: 4-13           [8, 961, 3072]            --
│    │    │    └─Linear: 4-14            [8, 961, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-15           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-4      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-19              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-20     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-21              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-22     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-23              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-24             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-16            [8, 961, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-17              [8, 961, 3072]            --
│    │    │    └─Dropout: 4-18           [8, 961, 3072]            --
│    │    │    └─Linear: 4-19            [8, 961, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-20           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-5      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-25              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-26     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-27              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-28     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-29              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-30             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-21            [8, 961, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-22              [8, 961, 3072]            --
│    │    │    └─Dropout: 4-23           [8, 961, 3072]            --
│    │    │    └─Linear: 4-24            [8, 961, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-25           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-6      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-31              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-32     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-33              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-34     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-35              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-36             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-26            [8, 961, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-27              [8, 961, 3072]            --
│    │    │    └─Dropout: 4-28           [8, 961, 3072]            --
│    │    │    └─Linear: 4-29            [8, 961, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-30           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-7      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-37              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-38     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-39              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-40     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-41              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-42             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-31            [8, 961, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-32              [8, 961, 3072]            --
│    │    │    └─Dropout: 4-33           [8, 961, 3072]            --
│    │    │    └─Linear: 4-34            [8, 961, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-35           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-8      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-43              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-44     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-45              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-46     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-47              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-48             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-36            [8, 961, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-37              [8, 961, 3072]            --
│    │    │    └─Dropout: 4-38           [8, 961, 3072]            --
│    │    │    └─Linear: 4-39            [8, 961, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-40           [8, 961, 768]             --
├─LayerNorm: 1-4                         [8, 961, 768]             1,536
│    └─weight                                                      ├─768
│    └─bias                                                        └─768
├─Sequential: 1-5                        [8, 961, 64]              --
│    └─0.weight                                                    ├─1,179,648
│    └─0.bias                                                      ├─1,536
│    └─3.weight                                                    ├─98,304
│    └─3.bias                                                      └─64
│    └─Linear: 2-9                       [8, 961, 1536]            1,181,184
│    │    └─weight                                                 ├─1,179,648
│    │    └─bias                                                   └─1,536
│    └─GELU: 2-10                        [8, 961, 1536]            --
│    └─Dropout: 2-11                     [8, 961, 1536]            --
│    └─Linear: 2-12                      [8, 961, 64]              98,368
│    │    └─weight                                                 ├─98,304
│    │    └─bias                                                   └─64
│    └─Tanh: 2-13                        [8, 961, 64]              --
==========================================================================================
Total params: 77,684,032
Trainable params: 77,684,032
Non-trainable params: 0
Total mult-adds (M): 696.56
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 3215.92
Params size (MB): 156.59
Estimated Total Size (MB): 3373.03
==========================================================================================
[2025-06-09 10:47:49] Total trainable parameters: 77,684,032
[2025-06-09 11:01:26] Configuration saved to: '/home/promise/jhernandez/3d-notebooks/3d/9jun25/9jun25/models/vit_pruebas_2/config/model_config.json'...
[2025-06-09 11:01:26] Warning: 3D input detected, ViT will reshape to process all slices: (B*D, C, H, W)
[2025-06-09 11:01:26] Enhanced ViT Configuration: 961 patches (31x31), 8 transformer blocks, 768 embedding dimension
[2025-06-09 11:01:26] Overlap ratio: 0.5, Effective stride: 4
[2025-06-09 11:01:27] Processing 3D input: flattening 8 slices into batch dimension
[2025-06-09 11:01:29] ==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
VisionTransformer                        [1, 1, 8, 128, 128]       738,816
├─pos_embed                                                        ├─738,048
├─cls_token                                                        └─768
├─Conv2d: 1-1                            [8, 768, 31, 31]          49,920
│    └─weight                                                      ├─49,152
│    └─bias                                                        └─768
├─Dropout: 1-2                           [8, 961, 768]             --
├─ModuleList: 1-3                        --                        --
│    └─0.norm1.weight                                              ├─768
│    └─0.norm1.bias                                                ├─768
│    └─0.attn.in_proj_weight                                       ├─1,769,472
│    └─0.attn.in_proj_bias                                         ├─2,304
│    └─0.attn.out_proj.weight                                      ├─589,824
│    └─0.attn.out_proj.bias                                        ├─768
│    └─0.spatial_norm.weight                                       ├─768
│    └─0.spatial_norm.bias                                         ├─768
│    └─0.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─0.spatial_attn.in_proj_bias                                 ├─2,304
│    └─0.spatial_attn.out_proj.weight                              ├─589,824
│    └─0.spatial_attn.out_proj.bias                                ├─768
│    └─0.norm2.weight                                              ├─768
│    └─0.norm2.bias                                                ├─768
│    └─0.mlp.0.weight                                              ├─1,769,472
│    └─0.mlp.0.bias                                                ├─2,304
│    └─0.mlp.3.weight                                              ├─1,769,472
│    └─0.mlp.3.bias                                                ├─768
│    └─1.norm1.weight                                              ├─768
│    └─1.norm1.bias                                                ├─768
│    └─1.attn.in_proj_weight                                       ├─1,769,472
│    └─1.attn.in_proj_bias                                         ├─2,304
│    └─1.attn.out_proj.weight                                      ├─589,824
│    └─1.attn.out_proj.bias                                        ├─768
│    └─1.spatial_norm.weight                                       ├─768
│    └─1.spatial_norm.bias                                         ├─768
│    └─1.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─1.spatial_attn.in_proj_bias                                 ├─2,304
│    └─1.spatial_attn.out_proj.weight                              ├─589,824
│    └─1.spatial_attn.out_proj.bias                                ├─768
│    └─1.norm2.weight                                              ├─768
│    └─1.norm2.bias                                                ├─768
│    └─1.mlp.0.weight                                              ├─1,769,472
│    └─1.mlp.0.bias                                                ├─2,304
│    └─1.mlp.3.weight                                              ├─1,769,472
│    └─1.mlp.3.bias                                                ├─768
│    └─2.norm1.weight                                              ├─768
│    └─2.norm1.bias                                                ├─768
│    └─2.attn.in_proj_weight                                       ├─1,769,472
│    └─2.attn.in_proj_bias                                         ├─2,304
│    └─2.attn.out_proj.weight                                      ├─589,824
│    └─2.attn.out_proj.bias                                        ├─768
│    └─2.spatial_norm.weight                                       ├─768
│    └─2.spatial_norm.bias                                         ├─768
│    └─2.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─2.spatial_attn.in_proj_bias                                 ├─2,304
│    └─2.spatial_attn.out_proj.weight                              ├─589,824
│    └─2.spatial_attn.out_proj.bias                                ├─768
│    └─2.norm2.weight                                              ├─768
│    └─2.norm2.bias                                                ├─768
│    └─2.mlp.0.weight                                              ├─1,769,472
│    └─2.mlp.0.bias                                                ├─2,304
│    └─2.mlp.3.weight                                              ├─1,769,472
│    └─2.mlp.3.bias                                                ├─768
│    └─3.norm1.weight                                              ├─768
│    └─3.norm1.bias                                                ├─768
│    └─3.attn.in_proj_weight                                       ├─1,769,472
│    └─3.attn.in_proj_bias                                         ├─2,304
│    └─3.attn.out_proj.weight                                      ├─589,824
│    └─3.attn.out_proj.bias                                        ├─768
│    └─3.spatial_norm.weight                                       ├─768
│    └─3.spatial_norm.bias                                         ├─768
│    └─3.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─3.spatial_attn.in_proj_bias                                 ├─2,304
│    └─3.spatial_attn.out_proj.weight                              ├─589,824
│    └─3.spatial_attn.out_proj.bias                                ├─768
│    └─3.norm2.weight                                              ├─768
│    └─3.norm2.bias                                                ├─768
│    └─3.mlp.0.weight                                              ├─1,769,472
│    └─3.mlp.0.bias                                                ├─2,304
│    └─3.mlp.3.weight                                              ├─1,769,472
│    └─3.mlp.3.bias                                                ├─768
│    └─4.norm1.weight                                              ├─768
│    └─4.norm1.bias                                                ├─768
│    └─4.attn.in_proj_weight                                       ├─1,769,472
│    └─4.attn.in_proj_bias                                         ├─2,304
│    └─4.attn.out_proj.weight                                      ├─589,824
│    └─4.attn.out_proj.bias                                        ├─768
│    └─4.spatial_norm.weight                                       ├─768
│    └─4.spatial_norm.bias                                         ├─768
│    └─4.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─4.spatial_attn.in_proj_bias                                 ├─2,304
│    └─4.spatial_attn.out_proj.weight                              ├─589,824
│    └─4.spatial_attn.out_proj.bias                                ├─768
│    └─4.norm2.weight                                              ├─768
│    └─4.norm2.bias                                                ├─768
│    └─4.mlp.0.weight                                              ├─1,769,472
│    └─4.mlp.0.bias                                                ├─2,304
│    └─4.mlp.3.weight                                              ├─1,769,472
│    └─4.mlp.3.bias                                                ├─768
│    └─5.norm1.weight                                              ├─768
│    └─5.norm1.bias                                                ├─768
│    └─5.attn.in_proj_weight                                       ├─1,769,472
│    └─5.attn.in_proj_bias                                         ├─2,304
│    └─5.attn.out_proj.weight                                      ├─589,824
│    └─5.attn.out_proj.bias                                        ├─768
│    └─5.spatial_norm.weight                                       ├─768
│    └─5.spatial_norm.bias                                         ├─768
│    └─5.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─5.spatial_attn.in_proj_bias                                 ├─2,304
│    └─5.spatial_attn.out_proj.weight                              ├─589,824
│    └─5.spatial_attn.out_proj.bias                                ├─768
│    └─5.norm2.weight                                              ├─768
│    └─5.norm2.bias                                                ├─768
│    └─5.mlp.0.weight                                              ├─1,769,472
│    └─5.mlp.0.bias                                                ├─2,304
│    └─5.mlp.3.weight                                              ├─1,769,472
│    └─5.mlp.3.bias                                                ├─768
│    └─6.norm1.weight                                              ├─768
│    └─6.norm1.bias                                                ├─768
│    └─6.attn.in_proj_weight                                       ├─1,769,472
│    └─6.attn.in_proj_bias                                         ├─2,304
│    └─6.attn.out_proj.weight                                      ├─589,824
│    └─6.attn.out_proj.bias                                        ├─768
│    └─6.spatial_norm.weight                                       ├─768
│    └─6.spatial_norm.bias                                         ├─768
│    └─6.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─6.spatial_attn.in_proj_bias                                 ├─2,304
│    └─6.spatial_attn.out_proj.weight                              ├─589,824
│    └─6.spatial_attn.out_proj.bias                                ├─768
│    └─6.norm2.weight                                              ├─768
│    └─6.norm2.bias                                                ├─768
│    └─6.mlp.0.weight                                              ├─1,769,472
│    └─6.mlp.0.bias                                                ├─2,304
│    └─6.mlp.3.weight                                              ├─1,769,472
│    └─6.mlp.3.bias                                                ├─768
│    └─7.norm1.weight                                              ├─768
│    └─7.norm1.bias                                                ├─768
│    └─7.attn.in_proj_weight                                       ├─1,769,472
│    └─7.attn.in_proj_bias                                         ├─2,304
│    └─7.attn.out_proj.weight                                      ├─589,824
│    └─7.attn.out_proj.bias                                        ├─768
│    └─7.spatial_norm.weight                                       ├─768
│    └─7.spatial_norm.bias                                         ├─768
│    └─7.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─7.spatial_attn.in_proj_bias                                 ├─2,304
│    └─7.spatial_attn.out_proj.weight                              ├─589,824
│    └─7.spatial_attn.out_proj.bias                                ├─768
│    └─7.norm2.weight                                              ├─768
│    └─7.norm2.bias                                                ├─768
│    └─7.mlp.0.weight                                              ├─1,769,472
│    └─7.mlp.0.bias                                                ├─2,304
│    └─7.mlp.3.weight                                              ├─1,769,472
│    └─7.mlp.3.bias                                                └─768
│    └─SpatialTransformerBlock: 2-1      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,769,472
│    │    └─mlp.0.bias                                             ├─2,304
│    │    └─mlp.3.weight                                           ├─1,769,472
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-1               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-2      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-3               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-4      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-5               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-6              [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,769,472
│    │    │    └─0.bias                                            ├─2,304
│    │    │    └─3.weight                                          ├─1,769,472
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-1             [8, 961, 2304]            1,771,776
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─2,304
│    │    │    └─GELU: 4-2               [8, 961, 2304]            --
│    │    │    └─Dropout: 4-3            [8, 961, 2304]            --
│    │    │    └─Linear: 4-4             [8, 961, 768]             1,770,240
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-5            [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-2      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,769,472
│    │    └─mlp.0.bias                                             ├─2,304
│    │    └─mlp.3.weight                                           ├─1,769,472
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-7               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-8      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-9               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-10     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-11              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-12             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,769,472
│    │    │    └─0.bias                                            ├─2,304
│    │    │    └─3.weight                                          ├─1,769,472
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-6             [8, 961, 2304]            1,771,776
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─2,304
│    │    │    └─GELU: 4-7               [8, 961, 2304]            --
│    │    │    └─Dropout: 4-8            [8, 961, 2304]            --
│    │    │    └─Linear: 4-9             [8, 961, 768]             1,770,240
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-10           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-3      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,769,472
│    │    └─mlp.0.bias                                             ├─2,304
│    │    └─mlp.3.weight                                           ├─1,769,472
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-13              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-14     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-15              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-16     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-17              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-18             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,769,472
│    │    │    └─0.bias                                            ├─2,304
│    │    │    └─3.weight                                          ├─1,769,472
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-11            [8, 961, 2304]            1,771,776
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─2,304
│    │    │    └─GELU: 4-12              [8, 961, 2304]            --
│    │    │    └─Dropout: 4-13           [8, 961, 2304]            --
│    │    │    └─Linear: 4-14            [8, 961, 768]             1,770,240
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-15           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-4      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,769,472
│    │    └─mlp.0.bias                                             ├─2,304
│    │    └─mlp.3.weight                                           ├─1,769,472
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-19              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-20     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-21              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-22     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-23              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-24             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,769,472
│    │    │    └─0.bias                                            ├─2,304
│    │    │    └─3.weight                                          ├─1,769,472
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-16            [8, 961, 2304]            1,771,776
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─2,304
│    │    │    └─GELU: 4-17              [8, 961, 2304]            --
│    │    │    └─Dropout: 4-18           [8, 961, 2304]            --
│    │    │    └─Linear: 4-19            [8, 961, 768]             1,770,240
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-20           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-5      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,769,472
│    │    └─mlp.0.bias                                             ├─2,304
│    │    └─mlp.3.weight                                           ├─1,769,472
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-25              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-26     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-27              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-28     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-29              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-30             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,769,472
│    │    │    └─0.bias                                            ├─2,304
│    │    │    └─3.weight                                          ├─1,769,472
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-21            [8, 961, 2304]            1,771,776
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─2,304
│    │    │    └─GELU: 4-22              [8, 961, 2304]            --
│    │    │    └─Dropout: 4-23           [8, 961, 2304]            --
│    │    │    └─Linear: 4-24            [8, 961, 768]             1,770,240
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-25           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-6      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,769,472
│    │    └─mlp.0.bias                                             ├─2,304
│    │    └─mlp.3.weight                                           ├─1,769,472
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-31              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-32     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-33              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-34     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-35              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-36             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,769,472
│    │    │    └─0.bias                                            ├─2,304
│    │    │    └─3.weight                                          ├─1,769,472
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-26            [8, 961, 2304]            1,771,776
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─2,304
│    │    │    └─GELU: 4-27              [8, 961, 2304]            --
│    │    │    └─Dropout: 4-28           [8, 961, 2304]            --
│    │    │    └─Linear: 4-29            [8, 961, 768]             1,770,240
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-30           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-7      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,769,472
│    │    └─mlp.0.bias                                             ├─2,304
│    │    └─mlp.3.weight                                           ├─1,769,472
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-37              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-38     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-39              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-40     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-41              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-42             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,769,472
│    │    │    └─0.bias                                            ├─2,304
│    │    │    └─3.weight                                          ├─1,769,472
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-31            [8, 961, 2304]            1,771,776
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─2,304
│    │    │    └─GELU: 4-32              [8, 961, 2304]            --
│    │    │    └─Dropout: 4-33           [8, 961, 2304]            --
│    │    │    └─Linear: 4-34            [8, 961, 768]             1,770,240
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-35           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-8      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,769,472
│    │    └─mlp.0.bias                                             ├─2,304
│    │    └─mlp.3.weight                                           ├─1,769,472
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-43              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-44     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-45              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-46     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-47              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-48             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,769,472
│    │    │    └─0.bias                                            ├─2,304
│    │    │    └─3.weight                                          ├─1,769,472
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-36            [8, 961, 2304]            1,771,776
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─2,304
│    │    │    └─GELU: 4-37              [8, 961, 2304]            --
│    │    │    └─Dropout: 4-38           [8, 961, 2304]            --
│    │    │    └─Linear: 4-39            [8, 961, 768]             1,770,240
│    │    │    │    └─weight                                       ├─1,769,472
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-40           [8, 961, 768]             --
├─LayerNorm: 1-4                         [8, 961, 768]             1,536
│    └─weight                                                      ├─768
│    └─bias                                                        └─768
├─Sequential: 1-5                        [8, 961, 64]              --
│    └─0.weight                                                    ├─1,179,648
│    └─0.bias                                                      ├─1,536
│    └─3.weight                                                    ├─98,304
│    └─3.bias                                                      └─64
│    └─Linear: 2-9                       [8, 961, 1536]            1,181,184
│    │    └─weight                                                 ├─1,179,648
│    │    └─bias                                                   └─1,536
│    └─GELU: 2-10                        [8, 961, 1536]            --
│    └─Dropout: 2-11                     [8, 961, 1536]            --
│    └─Linear: 2-12                      [8, 961, 64]              98,368
│    │    └─weight                                                 ├─98,304
│    │    └─bias                                                   └─64
│    └─Tanh: 2-13                        [8, 961, 64]              --
==========================================================================================
Total params: 68,240,704
Trainable params: 68,240,704
Non-trainable params: 0
Total mult-adds (M): 621.02
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 2838.04
Params size (MB): 118.82
Estimated Total Size (MB): 2957.38
==========================================================================================
[2025-06-09 11:01:29] Total trainable parameters: 68,240,704
[2025-06-09 11:02:11] Configuration saved to: '/home/promise/jhernandez/3d-notebooks/3d/9jun25/9jun25/models/vit_pruebas_2/config/model_config.json'...
[2025-06-09 11:02:11] Warning: 3D input detected, ViT will reshape to process all slices: (B*D, C, H, W)
[2025-06-09 11:02:11] Enhanced ViT Configuration: 961 patches (31x31), 8 transformer blocks, 768 embedding dimension
[2025-06-09 11:02:11] Overlap ratio: 0.5, Effective stride: 4
[2025-06-09 11:02:12] Processing 3D input: flattening 8 slices into batch dimension
[2025-06-09 11:02:14] ==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
VisionTransformer                        [1, 1, 8, 128, 128]       738,816
├─pos_embed                                                        ├─738,048
├─cls_token                                                        └─768
├─Conv2d: 1-1                            [8, 768, 31, 31]          49,920
│    └─weight                                                      ├─49,152
│    └─bias                                                        └─768
├─Dropout: 1-2                           [8, 961, 768]             --
├─ModuleList: 1-3                        --                        --
│    └─0.norm1.weight                                              ├─768
│    └─0.norm1.bias                                                ├─768
│    └─0.attn.in_proj_weight                                       ├─1,769,472
│    └─0.attn.in_proj_bias                                         ├─2,304
│    └─0.attn.out_proj.weight                                      ├─589,824
│    └─0.attn.out_proj.bias                                        ├─768
│    └─0.spatial_norm.weight                                       ├─768
│    └─0.spatial_norm.bias                                         ├─768
│    └─0.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─0.spatial_attn.in_proj_bias                                 ├─2,304
│    └─0.spatial_attn.out_proj.weight                              ├─589,824
│    └─0.spatial_attn.out_proj.bias                                ├─768
│    └─0.norm2.weight                                              ├─768
│    └─0.norm2.bias                                                ├─768
│    └─0.mlp.0.weight                                              ├─1,179,648
│    └─0.mlp.0.bias                                                ├─1,536
│    └─0.mlp.3.weight                                              ├─1,179,648
│    └─0.mlp.3.bias                                                ├─768
│    └─1.norm1.weight                                              ├─768
│    └─1.norm1.bias                                                ├─768
│    └─1.attn.in_proj_weight                                       ├─1,769,472
│    └─1.attn.in_proj_bias                                         ├─2,304
│    └─1.attn.out_proj.weight                                      ├─589,824
│    └─1.attn.out_proj.bias                                        ├─768
│    └─1.spatial_norm.weight                                       ├─768
│    └─1.spatial_norm.bias                                         ├─768
│    └─1.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─1.spatial_attn.in_proj_bias                                 ├─2,304
│    └─1.spatial_attn.out_proj.weight                              ├─589,824
│    └─1.spatial_attn.out_proj.bias                                ├─768
│    └─1.norm2.weight                                              ├─768
│    └─1.norm2.bias                                                ├─768
│    └─1.mlp.0.weight                                              ├─1,179,648
│    └─1.mlp.0.bias                                                ├─1,536
│    └─1.mlp.3.weight                                              ├─1,179,648
│    └─1.mlp.3.bias                                                ├─768
│    └─2.norm1.weight                                              ├─768
│    └─2.norm1.bias                                                ├─768
│    └─2.attn.in_proj_weight                                       ├─1,769,472
│    └─2.attn.in_proj_bias                                         ├─2,304
│    └─2.attn.out_proj.weight                                      ├─589,824
│    └─2.attn.out_proj.bias                                        ├─768
│    └─2.spatial_norm.weight                                       ├─768
│    └─2.spatial_norm.bias                                         ├─768
│    └─2.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─2.spatial_attn.in_proj_bias                                 ├─2,304
│    └─2.spatial_attn.out_proj.weight                              ├─589,824
│    └─2.spatial_attn.out_proj.bias                                ├─768
│    └─2.norm2.weight                                              ├─768
│    └─2.norm2.bias                                                ├─768
│    └─2.mlp.0.weight                                              ├─1,179,648
│    └─2.mlp.0.bias                                                ├─1,536
│    └─2.mlp.3.weight                                              ├─1,179,648
│    └─2.mlp.3.bias                                                ├─768
│    └─3.norm1.weight                                              ├─768
│    └─3.norm1.bias                                                ├─768
│    └─3.attn.in_proj_weight                                       ├─1,769,472
│    └─3.attn.in_proj_bias                                         ├─2,304
│    └─3.attn.out_proj.weight                                      ├─589,824
│    └─3.attn.out_proj.bias                                        ├─768
│    └─3.spatial_norm.weight                                       ├─768
│    └─3.spatial_norm.bias                                         ├─768
│    └─3.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─3.spatial_attn.in_proj_bias                                 ├─2,304
│    └─3.spatial_attn.out_proj.weight                              ├─589,824
│    └─3.spatial_attn.out_proj.bias                                ├─768
│    └─3.norm2.weight                                              ├─768
│    └─3.norm2.bias                                                ├─768
│    └─3.mlp.0.weight                                              ├─1,179,648
│    └─3.mlp.0.bias                                                ├─1,536
│    └─3.mlp.3.weight                                              ├─1,179,648
│    └─3.mlp.3.bias                                                ├─768
│    └─4.norm1.weight                                              ├─768
│    └─4.norm1.bias                                                ├─768
│    └─4.attn.in_proj_weight                                       ├─1,769,472
│    └─4.attn.in_proj_bias                                         ├─2,304
│    └─4.attn.out_proj.weight                                      ├─589,824
│    └─4.attn.out_proj.bias                                        ├─768
│    └─4.spatial_norm.weight                                       ├─768
│    └─4.spatial_norm.bias                                         ├─768
│    └─4.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─4.spatial_attn.in_proj_bias                                 ├─2,304
│    └─4.spatial_attn.out_proj.weight                              ├─589,824
│    └─4.spatial_attn.out_proj.bias                                ├─768
│    └─4.norm2.weight                                              ├─768
│    └─4.norm2.bias                                                ├─768
│    └─4.mlp.0.weight                                              ├─1,179,648
│    └─4.mlp.0.bias                                                ├─1,536
│    └─4.mlp.3.weight                                              ├─1,179,648
│    └─4.mlp.3.bias                                                ├─768
│    └─5.norm1.weight                                              ├─768
│    └─5.norm1.bias                                                ├─768
│    └─5.attn.in_proj_weight                                       ├─1,769,472
│    └─5.attn.in_proj_bias                                         ├─2,304
│    └─5.attn.out_proj.weight                                      ├─589,824
│    └─5.attn.out_proj.bias                                        ├─768
│    └─5.spatial_norm.weight                                       ├─768
│    └─5.spatial_norm.bias                                         ├─768
│    └─5.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─5.spatial_attn.in_proj_bias                                 ├─2,304
│    └─5.spatial_attn.out_proj.weight                              ├─589,824
│    └─5.spatial_attn.out_proj.bias                                ├─768
│    └─5.norm2.weight                                              ├─768
│    └─5.norm2.bias                                                ├─768
│    └─5.mlp.0.weight                                              ├─1,179,648
│    └─5.mlp.0.bias                                                ├─1,536
│    └─5.mlp.3.weight                                              ├─1,179,648
│    └─5.mlp.3.bias                                                ├─768
│    └─6.norm1.weight                                              ├─768
│    └─6.norm1.bias                                                ├─768
│    └─6.attn.in_proj_weight                                       ├─1,769,472
│    └─6.attn.in_proj_bias                                         ├─2,304
│    └─6.attn.out_proj.weight                                      ├─589,824
│    └─6.attn.out_proj.bias                                        ├─768
│    └─6.spatial_norm.weight                                       ├─768
│    └─6.spatial_norm.bias                                         ├─768
│    └─6.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─6.spatial_attn.in_proj_bias                                 ├─2,304
│    └─6.spatial_attn.out_proj.weight                              ├─589,824
│    └─6.spatial_attn.out_proj.bias                                ├─768
│    └─6.norm2.weight                                              ├─768
│    └─6.norm2.bias                                                ├─768
│    └─6.mlp.0.weight                                              ├─1,179,648
│    └─6.mlp.0.bias                                                ├─1,536
│    └─6.mlp.3.weight                                              ├─1,179,648
│    └─6.mlp.3.bias                                                ├─768
│    └─7.norm1.weight                                              ├─768
│    └─7.norm1.bias                                                ├─768
│    └─7.attn.in_proj_weight                                       ├─1,769,472
│    └─7.attn.in_proj_bias                                         ├─2,304
│    └─7.attn.out_proj.weight                                      ├─589,824
│    └─7.attn.out_proj.bias                                        ├─768
│    └─7.spatial_norm.weight                                       ├─768
│    └─7.spatial_norm.bias                                         ├─768
│    └─7.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─7.spatial_attn.in_proj_bias                                 ├─2,304
│    └─7.spatial_attn.out_proj.weight                              ├─589,824
│    └─7.spatial_attn.out_proj.bias                                ├─768
│    └─7.norm2.weight                                              ├─768
│    └─7.norm2.bias                                                ├─768
│    └─7.mlp.0.weight                                              ├─1,179,648
│    └─7.mlp.0.bias                                                ├─1,536
│    └─7.mlp.3.weight                                              ├─1,179,648
│    └─7.mlp.3.bias                                                └─768
│    └─SpatialTransformerBlock: 2-1      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-1               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-2      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-3               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-4      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-5               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-6              [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-1             [8, 961, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-2               [8, 961, 1536]            --
│    │    │    └─Dropout: 4-3            [8, 961, 1536]            --
│    │    │    └─Linear: 4-4             [8, 961, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-5            [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-2      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-7               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-8      [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-9               [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-10     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-11              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-12             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-6             [8, 961, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-7               [8, 961, 1536]            --
│    │    │    └─Dropout: 4-8            [8, 961, 1536]            --
│    │    │    └─Linear: 4-9             [8, 961, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-10           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-3      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-13              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-14     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-15              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-16     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-17              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-18             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-11            [8, 961, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-12              [8, 961, 1536]            --
│    │    │    └─Dropout: 4-13           [8, 961, 1536]            --
│    │    │    └─Linear: 4-14            [8, 961, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-15           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-4      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-19              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-20     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-21              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-22     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-23              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-24             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-16            [8, 961, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-17              [8, 961, 1536]            --
│    │    │    └─Dropout: 4-18           [8, 961, 1536]            --
│    │    │    └─Linear: 4-19            [8, 961, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-20           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-5      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-25              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-26     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-27              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-28     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-29              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-30             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-21            [8, 961, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-22              [8, 961, 1536]            --
│    │    │    └─Dropout: 4-23           [8, 961, 1536]            --
│    │    │    └─Linear: 4-24            [8, 961, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-25           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-6      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-31              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-32     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-33              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-34     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-35              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-36             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-26            [8, 961, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-27              [8, 961, 1536]            --
│    │    │    └─Dropout: 4-28           [8, 961, 1536]            --
│    │    │    └─Linear: 4-29            [8, 961, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-30           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-7      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-37              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-38     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-39              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-40     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-41              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-42             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-31            [8, 961, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-32              [8, 961, 1536]            --
│    │    │    └─Dropout: 4-33           [8, 961, 1536]            --
│    │    │    └─Linear: 4-34            [8, 961, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-35           [8, 961, 768]             --
│    └─SpatialTransformerBlock: 2-8      [8, 961, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-43              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-44     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-45              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-46     [8, 961, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-47              [8, 961, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-48             [8, 961, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-36            [8, 961, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-37              [8, 961, 1536]            --
│    │    │    └─Dropout: 4-38           [8, 961, 1536]            --
│    │    │    └─Linear: 4-39            [8, 961, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-40           [8, 961, 768]             --
├─LayerNorm: 1-4                         [8, 961, 768]             1,536
│    └─weight                                                      ├─768
│    └─bias                                                        └─768
├─Sequential: 1-5                        [8, 961, 64]              --
│    └─0.weight                                                    ├─1,179,648
│    └─0.bias                                                      ├─1,536
│    └─3.weight                                                    ├─98,304
│    └─3.bias                                                      └─64
│    └─Linear: 2-9                       [8, 961, 1536]            1,181,184
│    │    └─weight                                                 ├─1,179,648
│    │    └─bias                                                   └─1,536
│    └─GELU: 2-10                        [8, 961, 1536]            --
│    └─Dropout: 2-11                     [8, 961, 1536]            --
│    └─Linear: 2-12                      [8, 961, 64]              98,368
│    │    └─weight                                                 ├─98,304
│    │    └─bias                                                   └─64
│    └─Tanh: 2-13                        [8, 961, 64]              --
==========================================================================================
Total params: 58,797,376
Trainable params: 58,797,376
Non-trainable params: 0
Total mult-adds (M): 545.47
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 2460.16
Params size (MB): 81.04
Estimated Total Size (MB): 2541.73
==========================================================================================
[2025-06-09 11:02:14] Total trainable parameters: 58,797,376
[2025-06-09 11:02:36] Configuration saved to: '/home/promise/jhernandez/3d-notebooks/3d/9jun25/9jun25/models/vit_pruebas_2/config/model_config.json'...
[2025-06-09 11:02:36] Warning: 3D input detected, ViT will reshape to process all slices: (B*D, C, H, W)
[2025-06-09 11:02:36] Enhanced ViT Configuration: 225 patches (15x15), 8 transformer blocks, 768 embedding dimension
[2025-06-09 11:02:36] Overlap ratio: 0.5, Effective stride: 8
[2025-06-09 11:02:37] Processing 3D input: flattening 8 slices into batch dimension
[2025-06-09 11:02:37] ==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
VisionTransformer                        [1, 1, 8, 128, 128]       173,568
├─pos_embed                                                        ├─172,800
├─cls_token                                                        └─768
├─Conv2d: 1-1                            [8, 768, 15, 15]          197,376
│    └─weight                                                      ├─196,608
│    └─bias                                                        └─768
├─Dropout: 1-2                           [8, 225, 768]             --
├─ModuleList: 1-3                        --                        --
│    └─0.norm1.weight                                              ├─768
│    └─0.norm1.bias                                                ├─768
│    └─0.attn.in_proj_weight                                       ├─1,769,472
│    └─0.attn.in_proj_bias                                         ├─2,304
│    └─0.attn.out_proj.weight                                      ├─589,824
│    └─0.attn.out_proj.bias                                        ├─768
│    └─0.spatial_norm.weight                                       ├─768
│    └─0.spatial_norm.bias                                         ├─768
│    └─0.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─0.spatial_attn.in_proj_bias                                 ├─2,304
│    └─0.spatial_attn.out_proj.weight                              ├─589,824
│    └─0.spatial_attn.out_proj.bias                                ├─768
│    └─0.norm2.weight                                              ├─768
│    └─0.norm2.bias                                                ├─768
│    └─0.mlp.0.weight                                              ├─2,359,296
│    └─0.mlp.0.bias                                                ├─3,072
│    └─0.mlp.3.weight                                              ├─2,359,296
│    └─0.mlp.3.bias                                                ├─768
│    └─1.norm1.weight                                              ├─768
│    └─1.norm1.bias                                                ├─768
│    └─1.attn.in_proj_weight                                       ├─1,769,472
│    └─1.attn.in_proj_bias                                         ├─2,304
│    └─1.attn.out_proj.weight                                      ├─589,824
│    └─1.attn.out_proj.bias                                        ├─768
│    └─1.spatial_norm.weight                                       ├─768
│    └─1.spatial_norm.bias                                         ├─768
│    └─1.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─1.spatial_attn.in_proj_bias                                 ├─2,304
│    └─1.spatial_attn.out_proj.weight                              ├─589,824
│    └─1.spatial_attn.out_proj.bias                                ├─768
│    └─1.norm2.weight                                              ├─768
│    └─1.norm2.bias                                                ├─768
│    └─1.mlp.0.weight                                              ├─2,359,296
│    └─1.mlp.0.bias                                                ├─3,072
│    └─1.mlp.3.weight                                              ├─2,359,296
│    └─1.mlp.3.bias                                                ├─768
│    └─2.norm1.weight                                              ├─768
│    └─2.norm1.bias                                                ├─768
│    └─2.attn.in_proj_weight                                       ├─1,769,472
│    └─2.attn.in_proj_bias                                         ├─2,304
│    └─2.attn.out_proj.weight                                      ├─589,824
│    └─2.attn.out_proj.bias                                        ├─768
│    └─2.spatial_norm.weight                                       ├─768
│    └─2.spatial_norm.bias                                         ├─768
│    └─2.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─2.spatial_attn.in_proj_bias                                 ├─2,304
│    └─2.spatial_attn.out_proj.weight                              ├─589,824
│    └─2.spatial_attn.out_proj.bias                                ├─768
│    └─2.norm2.weight                                              ├─768
│    └─2.norm2.bias                                                ├─768
│    └─2.mlp.0.weight                                              ├─2,359,296
│    └─2.mlp.0.bias                                                ├─3,072
│    └─2.mlp.3.weight                                              ├─2,359,296
│    └─2.mlp.3.bias                                                ├─768
│    └─3.norm1.weight                                              ├─768
│    └─3.norm1.bias                                                ├─768
│    └─3.attn.in_proj_weight                                       ├─1,769,472
│    └─3.attn.in_proj_bias                                         ├─2,304
│    └─3.attn.out_proj.weight                                      ├─589,824
│    └─3.attn.out_proj.bias                                        ├─768
│    └─3.spatial_norm.weight                                       ├─768
│    └─3.spatial_norm.bias                                         ├─768
│    └─3.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─3.spatial_attn.in_proj_bias                                 ├─2,304
│    └─3.spatial_attn.out_proj.weight                              ├─589,824
│    └─3.spatial_attn.out_proj.bias                                ├─768
│    └─3.norm2.weight                                              ├─768
│    └─3.norm2.bias                                                ├─768
│    └─3.mlp.0.weight                                              ├─2,359,296
│    └─3.mlp.0.bias                                                ├─3,072
│    └─3.mlp.3.weight                                              ├─2,359,296
│    └─3.mlp.3.bias                                                ├─768
│    └─4.norm1.weight                                              ├─768
│    └─4.norm1.bias                                                ├─768
│    └─4.attn.in_proj_weight                                       ├─1,769,472
│    └─4.attn.in_proj_bias                                         ├─2,304
│    └─4.attn.out_proj.weight                                      ├─589,824
│    └─4.attn.out_proj.bias                                        ├─768
│    └─4.spatial_norm.weight                                       ├─768
│    └─4.spatial_norm.bias                                         ├─768
│    └─4.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─4.spatial_attn.in_proj_bias                                 ├─2,304
│    └─4.spatial_attn.out_proj.weight                              ├─589,824
│    └─4.spatial_attn.out_proj.bias                                ├─768
│    └─4.norm2.weight                                              ├─768
│    └─4.norm2.bias                                                ├─768
│    └─4.mlp.0.weight                                              ├─2,359,296
│    └─4.mlp.0.bias                                                ├─3,072
│    └─4.mlp.3.weight                                              ├─2,359,296
│    └─4.mlp.3.bias                                                ├─768
│    └─5.norm1.weight                                              ├─768
│    └─5.norm1.bias                                                ├─768
│    └─5.attn.in_proj_weight                                       ├─1,769,472
│    └─5.attn.in_proj_bias                                         ├─2,304
│    └─5.attn.out_proj.weight                                      ├─589,824
│    └─5.attn.out_proj.bias                                        ├─768
│    └─5.spatial_norm.weight                                       ├─768
│    └─5.spatial_norm.bias                                         ├─768
│    └─5.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─5.spatial_attn.in_proj_bias                                 ├─2,304
│    └─5.spatial_attn.out_proj.weight                              ├─589,824
│    └─5.spatial_attn.out_proj.bias                                ├─768
│    └─5.norm2.weight                                              ├─768
│    └─5.norm2.bias                                                ├─768
│    └─5.mlp.0.weight                                              ├─2,359,296
│    └─5.mlp.0.bias                                                ├─3,072
│    └─5.mlp.3.weight                                              ├─2,359,296
│    └─5.mlp.3.bias                                                ├─768
│    └─6.norm1.weight                                              ├─768
│    └─6.norm1.bias                                                ├─768
│    └─6.attn.in_proj_weight                                       ├─1,769,472
│    └─6.attn.in_proj_bias                                         ├─2,304
│    └─6.attn.out_proj.weight                                      ├─589,824
│    └─6.attn.out_proj.bias                                        ├─768
│    └─6.spatial_norm.weight                                       ├─768
│    └─6.spatial_norm.bias                                         ├─768
│    └─6.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─6.spatial_attn.in_proj_bias                                 ├─2,304
│    └─6.spatial_attn.out_proj.weight                              ├─589,824
│    └─6.spatial_attn.out_proj.bias                                ├─768
│    └─6.norm2.weight                                              ├─768
│    └─6.norm2.bias                                                ├─768
│    └─6.mlp.0.weight                                              ├─2,359,296
│    └─6.mlp.0.bias                                                ├─3,072
│    └─6.mlp.3.weight                                              ├─2,359,296
│    └─6.mlp.3.bias                                                ├─768
│    └─7.norm1.weight                                              ├─768
│    └─7.norm1.bias                                                ├─768
│    └─7.attn.in_proj_weight                                       ├─1,769,472
│    └─7.attn.in_proj_bias                                         ├─2,304
│    └─7.attn.out_proj.weight                                      ├─589,824
│    └─7.attn.out_proj.bias                                        ├─768
│    └─7.spatial_norm.weight                                       ├─768
│    └─7.spatial_norm.bias                                         ├─768
│    └─7.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─7.spatial_attn.in_proj_bias                                 ├─2,304
│    └─7.spatial_attn.out_proj.weight                              ├─589,824
│    └─7.spatial_attn.out_proj.bias                                ├─768
│    └─7.norm2.weight                                              ├─768
│    └─7.norm2.bias                                                ├─768
│    └─7.mlp.0.weight                                              ├─2,359,296
│    └─7.mlp.0.bias                                                ├─3,072
│    └─7.mlp.3.weight                                              ├─2,359,296
│    └─7.mlp.3.bias                                                └─768
│    └─SpatialTransformerBlock: 2-1      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-1               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-2      [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-3               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-4      [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-5               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-6              [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-1             [8, 225, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-2               [8, 225, 3072]            --
│    │    │    └─Dropout: 4-3            [8, 225, 3072]            --
│    │    │    └─Linear: 4-4             [8, 225, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-5            [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-2      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-7               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-8      [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-9               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-10     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-11              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-12             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-6             [8, 225, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-7               [8, 225, 3072]            --
│    │    │    └─Dropout: 4-8            [8, 225, 3072]            --
│    │    │    └─Linear: 4-9             [8, 225, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-10           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-3      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-13              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-14     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-15              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-16     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-17              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-18             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-11            [8, 225, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-12              [8, 225, 3072]            --
│    │    │    └─Dropout: 4-13           [8, 225, 3072]            --
│    │    │    └─Linear: 4-14            [8, 225, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-15           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-4      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-19              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-20     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-21              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-22     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-23              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-24             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-16            [8, 225, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-17              [8, 225, 3072]            --
│    │    │    └─Dropout: 4-18           [8, 225, 3072]            --
│    │    │    └─Linear: 4-19            [8, 225, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-20           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-5      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-25              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-26     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-27              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-28     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-29              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-30             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-21            [8, 225, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-22              [8, 225, 3072]            --
│    │    │    └─Dropout: 4-23           [8, 225, 3072]            --
│    │    │    └─Linear: 4-24            [8, 225, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-25           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-6      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-31              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-32     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-33              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-34     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-35              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-36             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-26            [8, 225, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-27              [8, 225, 3072]            --
│    │    │    └─Dropout: 4-28           [8, 225, 3072]            --
│    │    │    └─Linear: 4-29            [8, 225, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-30           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-7      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-37              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-38     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-39              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-40     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-41              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-42             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-31            [8, 225, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-32              [8, 225, 3072]            --
│    │    │    └─Dropout: 4-33           [8, 225, 3072]            --
│    │    │    └─Linear: 4-34            [8, 225, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-35           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-8      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─2,359,296
│    │    └─mlp.0.bias                                             ├─3,072
│    │    └─mlp.3.weight                                           ├─2,359,296
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-43              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-44     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-45              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-46     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-47              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-48             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─2,359,296
│    │    │    └─0.bias                                            ├─3,072
│    │    │    └─3.weight                                          ├─2,359,296
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-36            [8, 225, 3072]            2,362,368
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─3,072
│    │    │    └─GELU: 4-37              [8, 225, 3072]            --
│    │    │    └─Dropout: 4-38           [8, 225, 3072]            --
│    │    │    └─Linear: 4-39            [8, 225, 768]             2,360,064
│    │    │    │    └─weight                                       ├─2,359,296
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-40           [8, 225, 768]             --
├─LayerNorm: 1-4                         [8, 225, 768]             1,536
│    └─weight                                                      ├─768
│    └─bias                                                        └─768
├─Sequential: 1-5                        [8, 225, 256]             --
│    └─0.weight                                                    ├─1,179,648
│    └─0.bias                                                      ├─1,536
│    └─3.weight                                                    ├─393,216
│    └─3.bias                                                      └─256
│    └─Linear: 2-9                       [8, 225, 1536]            1,181,184
│    │    └─weight                                                 ├─1,179,648
│    │    └─bias                                                   └─1,536
│    └─GELU: 2-10                        [8, 225, 1536]            --
│    └─Dropout: 2-11                     [8, 225, 1536]            --
│    └─Linear: 2-12                      [8, 225, 256]             393,472
│    │    └─weight                                                 ├─393,216
│    │    └─bias                                                   └─256
│    └─Tanh: 2-13                        [8, 225, 256]             --
==========================================================================================
Total params: 77,561,344
Trainable params: 77,561,344
Non-trainable params: 0
Total mult-adds (M): 670.42
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 755.71
Params size (MB): 158.36
Estimated Total Size (MB): 914.60
==========================================================================================
[2025-06-09 11:02:37] Total trainable parameters: 77,561,344
[2025-06-09 11:04:55] Configuration saved to: '/home/promise/jhernandez/3d-notebooks/3d/9jun25/9jun25/models/vit_pruebas_2/config/model_config.json'...
[2025-06-09 11:04:55] Warning: 3D input detected, ViT will reshape to process all slices: (B*D, C, H, W)
[2025-06-09 11:04:55] Enhanced ViT Configuration: 225 patches (15x15), 8 transformer blocks, 768 embedding dimension
[2025-06-09 11:04:55] Overlap ratio: 0.5, Effective stride: 8
[2025-06-09 11:04:56] Processing 3D input: flattening 8 slices into batch dimension
[2025-06-09 11:04:56] ==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
VisionTransformer                        [1, 1, 8, 128, 128]       173,568
├─pos_embed                                                        ├─172,800
├─cls_token                                                        └─768
├─Conv2d: 1-1                            [8, 768, 15, 15]          197,376
│    └─weight                                                      ├─196,608
│    └─bias                                                        └─768
├─Dropout: 1-2                           [8, 225, 768]             --
├─ModuleList: 1-3                        --                        --
│    └─0.norm1.weight                                              ├─768
│    └─0.norm1.bias                                                ├─768
│    └─0.attn.in_proj_weight                                       ├─1,769,472
│    └─0.attn.in_proj_bias                                         ├─2,304
│    └─0.attn.out_proj.weight                                      ├─589,824
│    └─0.attn.out_proj.bias                                        ├─768
│    └─0.spatial_norm.weight                                       ├─768
│    └─0.spatial_norm.bias                                         ├─768
│    └─0.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─0.spatial_attn.in_proj_bias                                 ├─2,304
│    └─0.spatial_attn.out_proj.weight                              ├─589,824
│    └─0.spatial_attn.out_proj.bias                                ├─768
│    └─0.norm2.weight                                              ├─768
│    └─0.norm2.bias                                                ├─768
│    └─0.mlp.0.weight                                              ├─1,179,648
│    └─0.mlp.0.bias                                                ├─1,536
│    └─0.mlp.3.weight                                              ├─1,179,648
│    └─0.mlp.3.bias                                                ├─768
│    └─1.norm1.weight                                              ├─768
│    └─1.norm1.bias                                                ├─768
│    └─1.attn.in_proj_weight                                       ├─1,769,472
│    └─1.attn.in_proj_bias                                         ├─2,304
│    └─1.attn.out_proj.weight                                      ├─589,824
│    └─1.attn.out_proj.bias                                        ├─768
│    └─1.spatial_norm.weight                                       ├─768
│    └─1.spatial_norm.bias                                         ├─768
│    └─1.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─1.spatial_attn.in_proj_bias                                 ├─2,304
│    └─1.spatial_attn.out_proj.weight                              ├─589,824
│    └─1.spatial_attn.out_proj.bias                                ├─768
│    └─1.norm2.weight                                              ├─768
│    └─1.norm2.bias                                                ├─768
│    └─1.mlp.0.weight                                              ├─1,179,648
│    └─1.mlp.0.bias                                                ├─1,536
│    └─1.mlp.3.weight                                              ├─1,179,648
│    └─1.mlp.3.bias                                                ├─768
│    └─2.norm1.weight                                              ├─768
│    └─2.norm1.bias                                                ├─768
│    └─2.attn.in_proj_weight                                       ├─1,769,472
│    └─2.attn.in_proj_bias                                         ├─2,304
│    └─2.attn.out_proj.weight                                      ├─589,824
│    └─2.attn.out_proj.bias                                        ├─768
│    └─2.spatial_norm.weight                                       ├─768
│    └─2.spatial_norm.bias                                         ├─768
│    └─2.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─2.spatial_attn.in_proj_bias                                 ├─2,304
│    └─2.spatial_attn.out_proj.weight                              ├─589,824
│    └─2.spatial_attn.out_proj.bias                                ├─768
│    └─2.norm2.weight                                              ├─768
│    └─2.norm2.bias                                                ├─768
│    └─2.mlp.0.weight                                              ├─1,179,648
│    └─2.mlp.0.bias                                                ├─1,536
│    └─2.mlp.3.weight                                              ├─1,179,648
│    └─2.mlp.3.bias                                                ├─768
│    └─3.norm1.weight                                              ├─768
│    └─3.norm1.bias                                                ├─768
│    └─3.attn.in_proj_weight                                       ├─1,769,472
│    └─3.attn.in_proj_bias                                         ├─2,304
│    └─3.attn.out_proj.weight                                      ├─589,824
│    └─3.attn.out_proj.bias                                        ├─768
│    └─3.spatial_norm.weight                                       ├─768
│    └─3.spatial_norm.bias                                         ├─768
│    └─3.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─3.spatial_attn.in_proj_bias                                 ├─2,304
│    └─3.spatial_attn.out_proj.weight                              ├─589,824
│    └─3.spatial_attn.out_proj.bias                                ├─768
│    └─3.norm2.weight                                              ├─768
│    └─3.norm2.bias                                                ├─768
│    └─3.mlp.0.weight                                              ├─1,179,648
│    └─3.mlp.0.bias                                                ├─1,536
│    └─3.mlp.3.weight                                              ├─1,179,648
│    └─3.mlp.3.bias                                                ├─768
│    └─4.norm1.weight                                              ├─768
│    └─4.norm1.bias                                                ├─768
│    └─4.attn.in_proj_weight                                       ├─1,769,472
│    └─4.attn.in_proj_bias                                         ├─2,304
│    └─4.attn.out_proj.weight                                      ├─589,824
│    └─4.attn.out_proj.bias                                        ├─768
│    └─4.spatial_norm.weight                                       ├─768
│    └─4.spatial_norm.bias                                         ├─768
│    └─4.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─4.spatial_attn.in_proj_bias                                 ├─2,304
│    └─4.spatial_attn.out_proj.weight                              ├─589,824
│    └─4.spatial_attn.out_proj.bias                                ├─768
│    └─4.norm2.weight                                              ├─768
│    └─4.norm2.bias                                                ├─768
│    └─4.mlp.0.weight                                              ├─1,179,648
│    └─4.mlp.0.bias                                                ├─1,536
│    └─4.mlp.3.weight                                              ├─1,179,648
│    └─4.mlp.3.bias                                                ├─768
│    └─5.norm1.weight                                              ├─768
│    └─5.norm1.bias                                                ├─768
│    └─5.attn.in_proj_weight                                       ├─1,769,472
│    └─5.attn.in_proj_bias                                         ├─2,304
│    └─5.attn.out_proj.weight                                      ├─589,824
│    └─5.attn.out_proj.bias                                        ├─768
│    └─5.spatial_norm.weight                                       ├─768
│    └─5.spatial_norm.bias                                         ├─768
│    └─5.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─5.spatial_attn.in_proj_bias                                 ├─2,304
│    └─5.spatial_attn.out_proj.weight                              ├─589,824
│    └─5.spatial_attn.out_proj.bias                                ├─768
│    └─5.norm2.weight                                              ├─768
│    └─5.norm2.bias                                                ├─768
│    └─5.mlp.0.weight                                              ├─1,179,648
│    └─5.mlp.0.bias                                                ├─1,536
│    └─5.mlp.3.weight                                              ├─1,179,648
│    └─5.mlp.3.bias                                                ├─768
│    └─6.norm1.weight                                              ├─768
│    └─6.norm1.bias                                                ├─768
│    └─6.attn.in_proj_weight                                       ├─1,769,472
│    └─6.attn.in_proj_bias                                         ├─2,304
│    └─6.attn.out_proj.weight                                      ├─589,824
│    └─6.attn.out_proj.bias                                        ├─768
│    └─6.spatial_norm.weight                                       ├─768
│    └─6.spatial_norm.bias                                         ├─768
│    └─6.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─6.spatial_attn.in_proj_bias                                 ├─2,304
│    └─6.spatial_attn.out_proj.weight                              ├─589,824
│    └─6.spatial_attn.out_proj.bias                                ├─768
│    └─6.norm2.weight                                              ├─768
│    └─6.norm2.bias                                                ├─768
│    └─6.mlp.0.weight                                              ├─1,179,648
│    └─6.mlp.0.bias                                                ├─1,536
│    └─6.mlp.3.weight                                              ├─1,179,648
│    └─6.mlp.3.bias                                                ├─768
│    └─7.norm1.weight                                              ├─768
│    └─7.norm1.bias                                                ├─768
│    └─7.attn.in_proj_weight                                       ├─1,769,472
│    └─7.attn.in_proj_bias                                         ├─2,304
│    └─7.attn.out_proj.weight                                      ├─589,824
│    └─7.attn.out_proj.bias                                        ├─768
│    └─7.spatial_norm.weight                                       ├─768
│    └─7.spatial_norm.bias                                         ├─768
│    └─7.spatial_attn.in_proj_weight                               ├─1,769,472
│    └─7.spatial_attn.in_proj_bias                                 ├─2,304
│    └─7.spatial_attn.out_proj.weight                              ├─589,824
│    └─7.spatial_attn.out_proj.bias                                ├─768
│    └─7.norm2.weight                                              ├─768
│    └─7.norm2.bias                                                ├─768
│    └─7.mlp.0.weight                                              ├─1,179,648
│    └─7.mlp.0.bias                                                ├─1,536
│    └─7.mlp.3.weight                                              ├─1,179,648
│    └─7.mlp.3.bias                                                └─768
│    └─SpatialTransformerBlock: 2-1      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-1               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-2      [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-3               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-4      [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-5               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-6              [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-1             [8, 225, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-2               [8, 225, 1536]            --
│    │    │    └─Dropout: 4-3            [8, 225, 1536]            --
│    │    │    └─Linear: 4-4             [8, 225, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-5            [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-2      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-7               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-8      [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-9               [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-10     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-11              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-12             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-6             [8, 225, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-7               [8, 225, 1536]            --
│    │    │    └─Dropout: 4-8            [8, 225, 1536]            --
│    │    │    └─Linear: 4-9             [8, 225, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-10           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-3      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-13              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-14     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-15              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-16     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-17              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-18             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-11            [8, 225, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-12              [8, 225, 1536]            --
│    │    │    └─Dropout: 4-13           [8, 225, 1536]            --
│    │    │    └─Linear: 4-14            [8, 225, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-15           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-4      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-19              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-20     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-21              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-22     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-23              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-24             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-16            [8, 225, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-17              [8, 225, 1536]            --
│    │    │    └─Dropout: 4-18           [8, 225, 1536]            --
│    │    │    └─Linear: 4-19            [8, 225, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-20           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-5      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-25              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-26     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-27              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-28     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-29              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-30             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-21            [8, 225, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-22              [8, 225, 1536]            --
│    │    │    └─Dropout: 4-23           [8, 225, 1536]            --
│    │    │    └─Linear: 4-24            [8, 225, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-25           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-6      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-31              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-32     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-33              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-34     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-35              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-36             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-26            [8, 225, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-27              [8, 225, 1536]            --
│    │    │    └─Dropout: 4-28           [8, 225, 1536]            --
│    │    │    └─Linear: 4-29            [8, 225, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-30           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-7      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-37              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-38     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-39              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-40     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-41              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-42             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-31            [8, 225, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-32              [8, 225, 1536]            --
│    │    │    └─Dropout: 4-33           [8, 225, 1536]            --
│    │    │    └─Linear: 4-34            [8, 225, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-35           [8, 225, 768]             --
│    └─SpatialTransformerBlock: 2-8      [8, 225, 768]             --
│    │    └─norm1.weight                                           ├─768
│    │    └─norm1.bias                                             ├─768
│    │    └─attn.in_proj_weight                                    ├─1,769,472
│    │    └─attn.in_proj_bias                                      ├─2,304
│    │    └─attn.out_proj.weight                                   ├─589,824
│    │    └─attn.out_proj.bias                                     ├─768
│    │    └─spatial_norm.weight                                    ├─768
│    │    └─spatial_norm.bias                                      ├─768
│    │    └─spatial_attn.in_proj_weight                            ├─1,769,472
│    │    └─spatial_attn.in_proj_bias                              ├─2,304
│    │    └─spatial_attn.out_proj.weight                           ├─589,824
│    │    └─spatial_attn.out_proj.bias                             ├─768
│    │    └─norm2.weight                                           ├─768
│    │    └─norm2.bias                                             ├─768
│    │    └─mlp.0.weight                                           ├─1,179,648
│    │    └─mlp.0.bias                                             ├─1,536
│    │    └─mlp.3.weight                                           ├─1,179,648
│    │    └─mlp.3.bias                                             └─768
│    │    └─LayerNorm: 3-43              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-44     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-45              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─MultiheadAttention: 3-46     [8, 225, 768]             2,362,368
│    │    │    └─in_proj_weight                                    ├─1,769,472
│    │    │    └─in_proj_bias                                      ├─2,304
│    │    │    └─out_proj.weight                                   ├─589,824
│    │    │    └─out_proj.bias                                     └─768
│    │    └─LayerNorm: 3-47              [8, 225, 768]             1,536
│    │    │    └─weight                                            ├─768
│    │    │    └─bias                                              └─768
│    │    └─Sequential: 3-48             [8, 225, 768]             --
│    │    │    └─0.weight                                          ├─1,179,648
│    │    │    └─0.bias                                            ├─1,536
│    │    │    └─3.weight                                          ├─1,179,648
│    │    │    └─3.bias                                            └─768
│    │    │    └─Linear: 4-36            [8, 225, 1536]            1,181,184
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─1,536
│    │    │    └─GELU: 4-37              [8, 225, 1536]            --
│    │    │    └─Dropout: 4-38           [8, 225, 1536]            --
│    │    │    └─Linear: 4-39            [8, 225, 768]             1,180,416
│    │    │    │    └─weight                                       ├─1,179,648
│    │    │    │    └─bias                                         └─768
│    │    │    └─Dropout: 4-40           [8, 225, 768]             --
├─LayerNorm: 1-4                         [8, 225, 768]             1,536
│    └─weight                                                      ├─768
│    └─bias                                                        └─768
├─Sequential: 1-5                        [8, 225, 256]             --
│    └─0.weight                                                    ├─1,179,648
│    └─0.bias                                                      ├─1,536
│    └─3.weight                                                    ├─393,216
│    └─3.bias                                                      └─256
│    └─Linear: 2-9                       [8, 225, 1536]            1,181,184
│    │    └─weight                                                 ├─1,179,648
│    │    └─bias                                                   └─1,536
│    └─GELU: 2-10                        [8, 225, 1536]            --
│    └─Dropout: 2-11                     [8, 225, 1536]            --
│    └─Linear: 2-12                      [8, 225, 256]             393,472
│    │    └─weight                                                 ├─393,216
│    │    └─bias                                                   └─256
│    └─Tanh: 2-13                        [8, 225, 256]             --
==========================================================================================
Total params: 58,674,688
Trainable params: 58,674,688
Non-trainable params: 0
Total mult-adds (M): 519.32
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 578.76
Params size (MB): 82.81
Estimated Total Size (MB): 662.10
==========================================================================================
[2025-06-09 11:04:56] Total trainable parameters: 58,674,688
